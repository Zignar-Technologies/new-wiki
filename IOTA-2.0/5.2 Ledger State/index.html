<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Developing cyber-physical systems for Industry 4.0 requires great documentation. Our goal is to guarantee functionality and interoperability between the World, IoT, Software & AI, and DLT. We WILL make it happen !!!"><meta name=author content="Jorge Christian Gelso"><link href=https://docs.zignar.io/IOTA-2.0/5.2%20Ledger%20State/ rel=canonical><link rel=icon href=../../assets/favicon.svg><meta name=generator content="mkdocs-1.2.1, mkdocs-material-7.1.7+insiders-2.9.2"><title>5.2 Ledger State - Zignar Technologies Docs</title><link rel=stylesheet href=../../assets/stylesheets/main.92048cb8.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.73e53a79.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Montserrat:300,400,400i,700%7CSource+Code+Pro&display=fallback"><style>:root{--md-text-font-family:"Montserrat";--md-code-font-family:"Source Code Pro"}</style><link rel=stylesheet href=../../stylesheets/extra.css><meta name=robots content=noindex><meta property=og:type content=website><meta property=og:title content="Zignar Technologies Docs - 5.2 Ledger State"><meta property=og:description content="Developing cyber-physical systems for Industry 4.0 requires great documentation. Our goal is to guarantee functionality and interoperability between the World, IoT, Software & AI, and DLT. We WILL make it happen !!!"><meta content=https://docs.zignar.io/IOTA-2.0/5.2%20Ledger%20State/ property=og:url><meta property=og:image content=https://docs.zignar.io/assets/images/banner.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1080><meta property=og:image:height content=568><meta name=twitter:title content="Zignar Technologies Docs - 5.2 Ledger State"><meta name=twitter:description content="Developing cyber-physical systems for Industry 4.0 requires great documentation. Our goal is to guarantee functionality and interoperability between the World, IoT, Software & AI, and DLT. We WILL make it happen !!!"><meta name=twitter:image content=https://docs.zignar.io/assets/images/banner.png><link rel=stylesheet href=../../overrides/assets/stylesheets/main.3cfa086a.min.css></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=red> <script>function __scope(t,e="../.."){return new URL(e,location).pathname+"."+t}function __get(t,e=localStorage,n){return JSON.parse(e.getItem(__scope(t,n)))}function __set(t,e,n=localStorage,o){try{n.setItem(__scope(t,o),JSON.stringify(e))}catch(t){}}</script> <script>var palette=__get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#52-ledger-state class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> Zignar Technologies has it's own Documentation Website. For any improvements, please contact Chris at chris@zignar.tech </div> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Zignar Technologies Docs" class="md-header__button md-logo" aria-label="Zignar Technologies Docs" data-md-component=logo> <img src=../../assets/zignarlogo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Zignar Technologies Docs </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 5.2 Ledger State </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=red aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=light-blue data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/Zignar-Technologies/wiki/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"/></svg> </div> <div class=md-source__repository> Zignar Docs </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../ class="md-tabs__link md-tabs__link--active"> IOTA 2.0 Specs </a> </li> <li class=md-tabs__item> <a href=../../reference/basic-markdown/ class=md-tabs__link> Reference </a> </li> <li class=md-tabs__item> <a href=../../JTBD/barriers/ class=md-tabs__link> JTBD </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Zignar Technologies Docs" class="md-nav__button md-logo" aria-label="Zignar Technologies Docs" data-md-component=logo> <img src=../../assets/zignarlogo.png alt=logo> </a> Zignar Technologies Docs </label> <div class=md-nav__source> <a href=https://github.com/Zignar-Technologies/wiki/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"/></svg> </div> <div class=md-source__repository> Zignar Docs </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__link--container "> <a href=../ >IOTA 2.0 Specs</a> <label for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label="IOTA 2.0 Specs" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> IOTA 2.0 Specs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../0.0%20Preface/ class=md-nav__link> 0.0 Preface </a> </li> <li class=md-nav__item> <a href=../1.1%20Introduction/ class=md-nav__link> 1.1 Introduction </a> </li> <li class=md-nav__item> <a href=../2.2%20Message%20Layout/ class=md-nav__link> 2.2 Message Layout </a> </li> <li class=md-nav__item> <a href=../2.3%20Standard%20Payloads%20Layout/ class=md-nav__link> 2.3 Standard Payloads Layout </a> </li> <li class=md-nav__item> <a href=../2.4%20Data%20Flow/ class=md-nav__link> 2.4 Data flow </a> </li> <li class=md-nav__item> <a href=../3.3%20Peer%20Discovery/ class=md-nav__link> 3.3 Peer Discovery </a> </li> <li class=md-nav__item> <a href=../3.4%20Neighbor%20Selection/ class=md-nav__link> 3.4 Neighbor Selection </a> </li> <li class=md-nav__item> <a href=../4.1%20The%20Tangle/ class=md-nav__link> 4.1 The Tangle </a> </li> <li class=md-nav__item> <a href=../4.2%20Timestamps/ class=md-nav__link> 4.2 Timestamps </a> </li> <li class=md-nav__item> <a href=../4.3%20Tip%20Selection%20Algorithm/ class=md-nav__link> 4.3 Tip Selection Algorithm </a> </li> <li class=md-nav__item> <a href=../4.4%20Solidification/ class=md-nav__link> 4.4 Solidification </a> </li> <li class=md-nav__item> <a href=../4.5%20Rate%20Control/ class=md-nav__link> 4.5 Rate Control </a> </li> <li class=md-nav__item> <a href=../4.6%20Congestion%20Control/ class=md-nav__link> 4.6 Congestion control </a> </li> <li class=md-nav__item> <a href=../4.7%20Markers/ class=md-nav__link> 4.7 Markers </a> </li> <li class=md-nav__item> <a href=../5.1%20UTXO/ class=md-nav__link> 5.1 UTXO </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> 5.2 Ledger State <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> 5.2 Ledger State </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#521-introduction class=md-nav__link> 5.2.1 Introduction </a> </li> <li class=md-nav__item> <a href=#522-dependencies class=md-nav__link> 5.2.2 Dependencies </a> </li> <li class=md-nav__item> <a href=#523-realities-ledger-state class=md-nav__link> 5.2.3 Realities Ledger State </a> </li> <li class=md-nav__item> <a href=#524-the-utxo-dag class=md-nav__link> 5.2.4 The UTXO DAG </a> <nav class=md-nav aria-label="5.2.4 The UTXO DAG"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#5241-conflict-sets-and-detection-of-double-spends class=md-nav__link> 5.2.4.1 Conflict sets and detection of double spends </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#525-branches class=md-nav__link> 5.2.5 Branches </a> <nav class=md-nav aria-label="5.2.5 Branches"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#5251-conflict-branches class=md-nav__link> 5.2.5.1 Conflict branches </a> </li> <li class=md-nav__item> <a href=#5252-aggregated-branches class=md-nav__link> 5.2.5.2 Aggregated branches </a> </li> <li class=md-nav__item> <a href=#5253-the-branch-dag class=md-nav__link> 5.2.5.3 The branch DAG </a> </li> <li class=md-nav__item> <a href=#5254-detecting-conflicting-branches class=md-nav__link> 5.2.5.4 Detecting conflicting branches </a> </li> <li class=md-nav__item> <a href=#5255-merging-of-branches class=md-nav__link> 5.2.5.5 Merging of branches </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#526-relation-to-the-tangle class=md-nav__link> 5.2.6 Relation to the Tangle </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../5.3%20Mana/ class=md-nav__link> 5.3 Mana </a> </li> <li class=md-nav__item> <a href=../6.1%20Objects%20of%20Consensus/ class=md-nav__link> 6.1 Objects of Consensus </a> </li> <li class=md-nav__item> <a href=../6.2%20Opinion%20Setting/ class=md-nav__link> 6.2 Opinion Setting </a> </li> <li class=md-nav__item> <a href=../6.3%20Fast%20Probabilistic%20Consensus/ class=md-nav__link> 6.3 Fast Probabilistic Consensus </a> </li> <li class=md-nav__item> <a href=../6.4%20Finalization/ class=md-nav__link> 6.4 Finalization </a> </li> <li class=md-nav__item> <a href=../6.5%20dRNG/ class=md-nav__link> 6.5 dRNG </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Reference <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Reference data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../reference/basic-markdown/ class=md-nav__link> Basic Markdown Guide </a> </li> <li class=md-nav__item> <a href=../../reference/abbreviations/ class=md-nav__link> Abbreviations </a> </li> <li class=md-nav__item> <a href=../../reference/buttons/ class=md-nav__link> Buttons </a> </li> <li class=md-nav__item> <a href=../../reference/code-blocks/ class=md-nav__link> Code blocks </a> </li> <li class=md-nav__item> <a href=../../reference/content-tabs/ class=md-nav__link> Content tabs </a> </li> <li class=md-nav__item> <a href=../../reference/data-tables/ class=md-nav__link> Data tables </a> </li> <li class=md-nav__item> <a href=../../reference/diagrams/ class=md-nav__link> Diagrams </a> </li> <li class=md-nav__item> <a href=../../reference/footnotes/ class=md-nav__link> Footnotes </a> </li> <li class=md-nav__item> <a href=../../reference/formatting/ class=md-nav__link> Formatting </a> </li> <li class=md-nav__item> <a href=../../reference/icons-emojis/ class=md-nav__link> Icons + Emojis </a> </li> <li class=md-nav__item> <a href=../../reference/images/ class=md-nav__link> Images </a> </li> <li class=md-nav__item> <a href=../../reference/lists/ class=md-nav__link> Lists </a> </li> <li class=md-nav__item> <a href=../../reference/mathjax/ class=md-nav__link> MathJax </a> </li> <li class=md-nav__item> <a href=../../reference/pdf/ class=md-nav__link> PDF Files Support </a> </li> <li class=md-nav__item> <a href=../../reference/progress/ class=md-nav__link> Progress Bar </a> </li> <li class=md-nav__item> <a href=../../reference/remarks/ class=md-nav__link> Remarks </a> </li> <li class=md-nav__item> <a href=../../reference/smartsymbols/ class=md-nav__link> Smart symbols </a> </li> <li class=md-nav__item> <a href=../../reference/stl/ class=md-nav__link> STL Files Support </a> </li> <li class=md-nav__item> <a href=../../reference/installation/ class=md-nav__link> Installation Guide </a> </li> <li class=md-nav__item> <a href=../../reference/awesome/ class=md-nav__link> Customizing Navigation </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> JTBD <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=JTBD data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> JTBD </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../JTBD/barriers/ class=md-nav__link> Five barriers to innovation </a> </li> <li class=md-nav__item> <a href=../../JTBD/jtbd/ class=md-nav__link> What is Jobs-to-be-done </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#521-introduction class=md-nav__link> 5.2.1 Introduction </a> </li> <li class=md-nav__item> <a href=#522-dependencies class=md-nav__link> 5.2.2 Dependencies </a> </li> <li class=md-nav__item> <a href=#523-realities-ledger-state class=md-nav__link> 5.2.3 Realities Ledger State </a> </li> <li class=md-nav__item> <a href=#524-the-utxo-dag class=md-nav__link> 5.2.4 The UTXO DAG </a> <nav class=md-nav aria-label="5.2.4 The UTXO DAG"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#5241-conflict-sets-and-detection-of-double-spends class=md-nav__link> 5.2.4.1 Conflict sets and detection of double spends </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#525-branches class=md-nav__link> 5.2.5 Branches </a> <nav class=md-nav aria-label="5.2.5 Branches"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#5251-conflict-branches class=md-nav__link> 5.2.5.1 Conflict branches </a> </li> <li class=md-nav__item> <a href=#5252-aggregated-branches class=md-nav__link> 5.2.5.2 Aggregated branches </a> </li> <li class=md-nav__item> <a href=#5253-the-branch-dag class=md-nav__link> 5.2.5.3 The branch DAG </a> </li> <li class=md-nav__item> <a href=#5254-detecting-conflicting-branches class=md-nav__link> 5.2.5.4 Detecting conflicting branches </a> </li> <li class=md-nav__item> <a href=#5255-merging-of-branches class=md-nav__link> 5.2.5.5 Merging of branches </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#526-relation-to-the-tangle class=md-nav__link> 5.2.6 Relation to the Tangle </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href="https://github.com/Zignar-Technologies/wiki/tree/main/docs/IOTA-2.0/5.2 Ledger State.md" title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1 id=52-ledger-state>5.2 Ledger State<a class=headerlink href=#52-ledger-state title="Permanent link">&para;</a></h1> <h2 id=521-introduction>5.2.1 Introduction<a class=headerlink href=#521-introduction title="Permanent link">&para;</a></h2> <p>The introduction of a voting-based consensus requires a fast and easy way to determine a node's initial opinion for every received transaction. This includes the ability to both detect double spends and transactions that try to spend non-existing funds. These conditions are fulfilled by the introduction of an Unspent Transaction Output (UTXO) model for record-keeping, which enables the validation of transactions in real time, see also the section on <a href=../5.1%20UTXO/ >UTXO</a>.</p> <p>The concept of UTXO style transactions is directly linked to the creation of a directed acyclic graph (DAG), in which the vertices are transactions and the links between these are determined by the outputs and inputs of transactions. </p> <p>To deal with double spends and leverage on certain properties of UTXO, we introduce the Realities Ledger State. </p> <h2 id=522-dependencies>5.2.2 Dependencies<a class=headerlink href=#522-dependencies title="Permanent link">&para;</a></h2> <p>The <em>Ledger State</em> depends on:</p> <ul> <li>UTXO: see the Section on <a href=#5.2.4%20The%20UTXO%20DAG>UTXO DAG</a> as well as <a href=../5.1%20UTXO/ >5.1 UTXO</a>.</li> <li>Tangle: the Tangle maps the approval relations between messages as well as transactions, see <a href=../4.1%20The%20Tangle/ >4.1 The Tangle</a>.</li> <li>Solidification: Secures that all non-conflicting transactions converge to the same ledger state, see <a href=../4.4%20Solidification/ >4.4 Solidification</a>. </li> </ul> <h2 id=523-realities-ledger-state>5.2.3 Realities Ledger State<a class=headerlink href=#523-realities-ledger-state title="Permanent link">&para;</a></h2> <p>In the Realities Ledger State, we model the different perceptions of the ledger state that exist in the Tangle. In each “reality” on its own there are zero conflicting transactions. Each reality thus forms an in itself consistent UTXO sub-DAG, where every transaction references any other transaction correctly.</p> <p>Since outputs of transactions can only be consumed once, a transaction that double spends outputs creates a persistent branch in a corresponding UTXO DAG. Each branch receives a unique identifier <code>branchID</code>. These branches cannot be merged by any vertices (transactions). A transaction that attempts to merge incompatible branches fails to pass a validity check and is marked as invalid.</p> <p>The composition of all realities defines the Realities Ledger State. </p> <p>From this composition nodes are able to know which possible outcomes for the Tangle exist, where they split, how they relate to each other, if they can be merged and which messages are valid tips. All of this information can be retrieved in a fast and efficient way without having to walk the Tangle. </p> <p>Ultimately, for a set of competing realities, only one reality can survive. It is then up to the consensus protocol to determine which branch is part of the eventually accepted reality.</p> <p>In total the ledger state thus involves three different layers: * the <a href=#5.2.4%20The%20UTXO%20DAG>UTXO DAG</a>, * its extension to the corresponding <a href=#5.2.5%20Branches>branches</a> and the <a href=#5.2.5.3%20The%20branch%20DAG>branch DAG</a>, * the Tangle, which maps the parent relations between messages and thus also transactions.</p> <h2 id=524-the-utxo-dag>5.2.4 The UTXO DAG<a class=headerlink href=#524-the-utxo-dag title="Permanent link">&para;</a></h2> <p>The UTXO DAG models the relationship between transactions, by tracking which outputs have been spent by what transaction, see also the section on <a href=../5.1%20UTXO/ >UTXO</a>. Since outputs can only be spent once, we use this property to detect double spends. </p> <p>We allow for different versions of the ledger to coexist temporarily. This is enabled by extending the UTXO DAG by the introduction of branches (see the following section). We can then determine which conflicting versions of the ledger state exist in the presence of conflicts. Thus, we allow for different versions of the ledger to coexist temporarily. </p> <h3 id=5241-conflict-sets-and-detection-of-double-spends>5.2.4.1 Conflict sets and detection of double spends<a class=headerlink href=#5241-conflict-sets-and-detection-of-double-spends title="Permanent link">&para;</a></h3> <p>For every output we maintain a list of consumers <code>consumerList</code>, and where the consumers have the unique identifier <code>consumerID</code>. For a given output this list keeps track of which transactions have spent that particular output. For every spending transaction we add an element with <code>consumerID=transactionID</code>. Outputs without consumers are considered to be unspent outputs. Transactions that consume an output that have more than one consumer are considered to be double spends. </p> <p>When there are more than one consumer in the consumer list we <em>shall</em> create a conflict set list <code>conflictSet</code>, whose elements have a unique identifier <code>conflictID</code> each. The <code>conflictSet</code> is uniquely identified by the unique identifier <code>conflictSetID</code>. Since the <code>outputID</code> is directly and uniquely linked to the conflict set, we set <code>conflictSetID=outputID</code>. For every transaction that <em>shall</em> be added to the conflict set we add an element with <code>conflictID=transactionID</code>.</p> <h2 id=525-branches>5.2.5 Branches<a class=headerlink href=#525-branches title="Permanent link">&para;</a></h2> <p>The UTXO model and the concept of solidification, see section <a href=../4.4%20Solidification/ >4.4 Solidification</a>, makes all non-conflicting transactions converge to the same ledger state no matter in which order the transactions are received. Messages containing these transactions could always reference each other in the Tangle without limitations.</p> <p>However, every double spend creates a new possible version of the ledger state that will no longer converge. Whenever a double spend is detected (see the previous section), we track the outputs created by the conflicting transactions and all the transactions that spend these outputs, by creating a container for them in the ledger which we call a branch. </p> <p>More specifically a container <code>branch</code> <em>shall</em> be created for each transaction that double spends one or several outputs, or if messages aggregate those branches. Every transaction that spends directly or indirectly from a transaction that created a branch, i.e. double spent funds, is also contained in this <code>branch</code> or one of its child branches. Note that a branch that was created by a transaction that spends multiple outputs can be part of multiple conflict sets.</p> <p>In other words, a branch is a downward closed, conflict free collection of conflicts.</p> <p>Every branch <em>shall</em> be identified by the unique identifier <code>branchID</code>. We consider two kinds of branches: conflict branches and aggregated branches, which are explained in the following sections.</p> <h3 id=5251-conflict-branches>5.2.5.1 Conflict branches<a class=headerlink href=#5251-conflict-branches title="Permanent link">&para;</a></h3> <p>A conflict branch is created by a corresponding double spend transaction. Since the transaction identifier is unique, we choose the transaction id <code>transactionID</code> of the double spending transaction as the <code>branchID</code>.</p> <p>Outputs inside a branch can be double spent again, recursively forming sub-branches. </p> <p>On solidification of a message, we <em>shall</em> store the corresponding <code>branchID</code> together with every output, as well as the transaction metadata to enable instant lookups of this information. Thus, on solidification, a transaction can be immediately associated with a branch. </p> <h3 id=5252-aggregated-branches>5.2.5.2 Aggregated branches<a class=headerlink href=#5252-aggregated-branches title="Permanent link">&para;</a></h3> <p>A transaction that does not create a double spend inherits the branches of the input's branches. In the simplest case, where there is only one input branch the transaction inherits that branch. If outputs from multiple non-conflicting branches are spent in the same transaction, then the transaction and its resulting outputs are part of an aggregated branch. This type of branch is not part of any conflict set. Rather it simply combines the perception that the individual conflict branches associated to the transaction's inputs are the ones that will be accepted by the network. </p> <p>Furthermore, since a message inherits the branches from its parents, it also can create aggregated branches.</p> <p>Each aggregated branch <em>shall</em> have a unique identifier <code>branchID</code>, which is the same type as for conflict branches. Furthermore, the container for an aggregated branch is also of type <code>branch</code>. </p> <p>To calculate the unique identifier of a new aggregated branch, we take the identifiers of the branches that were aggregated, sort them lexicographically and hash the concatenated identifiers once:</p> <div class=highlight><pre><span></span><code><span class=p>#</span> <span class=n>AggregatedBranchID</span> <span class=n>returns</span> <span class=n>the</span> <span class=n>identifier</span> <span class=k>for</span> <span class=n>an</span> <span class=n>aggregated</span> <span class=n>branch</span><span class=p>.</span>
<span class=k>FUNCTION</span> <span class=nf>aggregatedBranchID</span> <span class=o>=</span> <span class=n>GetAggregatedBranchID</span><span class=p>(</span><span class=n>branchIDs</span><span class=p>)</span>
    <span class=n>sortedBranchIDs</span> <span class=o>=</span> <span class=n>Sort</span><span class=p>(</span><span class=n>branchIDs</span><span class=p>)</span>
    <span class=k>RETURN</span> <span class=n>Hash</span><span class=p>(</span><span class=n>sortedBranchIDs</span><span class=p>)</span>
</code></pre></div> <p>An aggregated branch can't aggregate other aggregated branches. However, it can aggregate the conflict branches that are part of the referenced aggregated branch. Thus aggregated branches have no further branches as their children and they remain tips in the branch DAG. Furthermore, the sortation of the <code>branchID</code>s in the function <code>AggregatedBranchID()</code> ensures that even though messages can attach at different points in the Tangle and aggregate different aggregated branches they are treated as if they are in the same aggregated branch <strong>if</strong> the referenced conflict branches are the same. </p> <p>These properties allow for an efficient reduction of a set of branches. In the following we will require the following fields as part of the branch data: * <code>isConflictBranch</code> is a boolean flat that is <code>TRUE</code> if the branch is a conflict branch or <code>FALSE</code> if its an aggregated branch. * <code>parentBranches</code> contains the list of parent conflict branches of the branch, i.e. the conflict branches that are directly referenced by this branch.</p> <p>Then the following function takes a list of branches (which can be either conflict or aggregated branches) and returns a unique set of conflict branches that these branches represent. This is done by replacing duplicates and extracting the parent conflict branches from aggregated branches. </p> <div class=highlight><pre><span></span><code><span class=k>FUNCTION</span> <span class=nf>reducedBranches</span> <span class=o>=</span> <span class=n>ReduceBranches</span><span class=p>(</span><span class=n>branches</span><span class=p>)</span>
    <span class=k>FOR</span> <span class=n>branch</span> <span class=ow>IN</span> <span class=n>branches</span>
        <span class=k>IF</span> <span class=n>branch</span><span class=p>.</span><span class=n>isConflictBranch</span>
            <span class=k>IF</span> <span class=k>NOT</span> <span class=p>(</span><span class=n>branch</span> <span class=ow>IN</span> <span class=n>reducedBranches</span><span class=p>)</span>
                <span class=n>Append</span><span class=p>(</span><span class=n>reducedBranches</span><span class=p>,</span><span class=n>branch</span><span class=p>)</span>
        <span class=k>ELSE</span>
            <span class=k>FOR</span> <span class=n>parentBranch</span> <span class=ow>IN</span> <span class=n>branch</span><span class=p>.</span><span class=n>parentBranches</span>
                <span class=k>IF</span> <span class=k>NOT</span> <span class=p>(</span><span class=n>parentBranch</span> <span class=ow>IN</span> <span class=n>reducedBranches</span><span class=p>)</span>
                    <span class=n>Append</span><span class=p>(</span><span class=n>reducedBranches</span><span class=p>,</span><span class=n>parentBranch</span><span class=p>)</span>
    <span class=k>RETURN</span> <span class=n>reducedBranches</span>
</code></pre></div> <h3 id=5253-the-branch-dag>5.2.5.3 The branch DAG<a class=headerlink href=#5253-the-branch-dag title="Permanent link">&para;</a></h3> <p>A new branch is created for each transaction that is part of a conflict set, or if a transaction aggregates branches.</p> <p>In the branch DAG, branches constitute the vertices of the DAG. A branch that is created by a transaction that is spending outputs from other branches has edges pointing to those branches. The branch DAG maps the UTXO DAG to a simpler structure that ignores details about relations between transactions inside the branches and instead retains only details about the interrelations of conflicts.</p> <p>The set of all non-conflicting transactions form the master branch. Thus, at its root the branch DAG has the master branch, which consists of non-conflicting transaction and resolved transactions. From this root of the branch DAG the various branches emerge. </p> <p>In other words the conflict branches and the aggregated branches appear as the children of the master branch. </p> <h3 id=5254-detecting-conflicting-branches>5.2.5.4 Detecting conflicting branches<a class=headerlink href=#5254-detecting-conflicting-branches title="Permanent link">&para;</a></h3> <p>Branches are conflicting if they, or any of their ancestors, are part of the same conflict set.</p> <p>The branch DAG can be used to check if branches are conflicting, by applying an operation called normalization, to a set of input branches.</p> <p>From this information we can identify messages or transactions that are trying to combine branches belonging to conflicting double spends, and thus introduce an invalid perception of the ledger state.</p> <p>Since branches represent the ledger state associated with a double spend and sub-branches implicitly share the perception of their parents, we define a function <code>NormalizeBranches()</code> to normalize a list of branches and that gets rid of all branches that are referenced by other branches in that list. The function returns <code>NULL</code> if the branches are conflicting and can not be merged.</p> <p>In order to explain this function in pseudo code we require the following global variables - seenConflictSets = map[]conflictSetID - traversedBranches = map[]branch - parentsToCheck = map[]branch</p> <p>as well as a function <code>BranchCheck()</code> that performs certain checks and returns <code>TRUE</code> when the branch is conflicting with a previously seen branch. However, we note that this is an implementation detail that must not match the implementation.</p> <div class=highlight><pre><span></span><code><span class=p>#</span> <span class=n>reduce</span> <span class=n>list</span> <span class=k>of</span> <span class=n>branches</span> <span class=k>to</span> <span class=n>normalized</span> <span class=n>branches</span><span class=p>,</span> <span class=ow>and</span> <span class=k>return</span> <span class=n>NULL</span> <span class=k>when</span> <span class=n>detecting</span> <span class=n>conflicting</span> <span class=n>branches</span>
<span class=k>FUNCTION</span> <span class=nf>normalizedBranches</span> <span class=o>=</span> <span class=n>NormalizeBranches</span><span class=p>(</span><span class=n>initialBranches</span><span class=p>)</span>
    <span class=k>IF</span> <span class=n>Len</span><span class=p>(</span><span class=n>initialBranches</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span>
        <span class=k>RETURN</span> <span class=n>masterBranch</span>
    <span class=k>IF</span> <span class=n>Len</span><span class=p>(</span><span class=n>initialBranches</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span>
        <span class=k>RETURN</span> <span class=n>initialBranches</span>

    <span class=p>#</span> <span class=n>check</span> <span class=n>original</span> <span class=k>set</span> <span class=k>of</span> <span class=n>branches</span>
    <span class=n>normalizedBranches</span> <span class=o>=</span> <span class=n>ReduceBranches</span><span class=p>(</span><span class=n>initialBranches</span><span class=p>)</span>
    <span class=k>FOR</span> <span class=n>branch</span> <span class=ow>IN</span> <span class=n>normalizedBranches</span>
        <span class=n>BranchCheck</span><span class=p>(</span><span class=n>branch</span><span class=p>)</span>

    <span class=p>#</span> <span class=n>check</span> <span class=n>every</span> <span class=n>ancestor</span>
    <span class=k>WHILE</span> <span class=n>Len</span><span class=p>(</span><span class=n>parentsToCheck</span><span class=p>)</span> <span class=p>!</span><span class=o>=</span> <span class=mi>0</span>
        <span class=n>branch</span> <span class=o>=</span> <span class=n>parentsToCheck</span><span class=o>[</span><span class=mi>0</span><span class=o>]</span>
        <span class=n>Delete</span><span class=p>(</span><span class=n>parentsToCheck</span><span class=p>,</span><span class=n>branch</span><span class=p>)</span> <span class=p>#</span> <span class=n>delete</span> <span class=n>this</span> <span class=n>branch</span> <span class=n>from</span> <span class=n>the</span> <span class=n>list</span>
        <span class=p>#</span> <span class=n>remove</span> <span class=n>this</span> <span class=n>ancestor</span>
        <span class=k>IF</span> <span class=n>branch</span> <span class=ow>IN</span> <span class=n>normalizedBranches</span>
            <span class=n>Delete</span><span class=p>(</span><span class=n>normalizedBranches</span><span class=p>,</span><span class=n>branch</span><span class=p>)</span>
        <span class=p>#</span> <span class=k>if</span> <span class=n>branch</span> <span class=n>check</span> <span class=n>fails</span><span class=p>,</span> <span class=n>i</span><span class=p>.</span><span class=n>e</span><span class=p>.</span> <span class=n>a</span> <span class=n>conflict</span> <span class=k>set</span> <span class=n>was</span> <span class=n>seen</span> <span class=n>twice</span><span class=p>,</span> <span class=k>return</span> <span class=n>a</span> <span class=n>null</span> <span class=n>list</span>
        <span class=k>IF</span> <span class=n>BranchCheck</span><span class=p>(</span><span class=n>branch</span><span class=p>)</span> 
            <span class=k>RETURN</span> <span class=n>NULL</span>

    <span class=k>RETURN</span> <span class=n>normalizedBranches</span>
</code></pre></div> <p>The branch check function <code>BranchCheck()</code> checks if the branch was already traversed, i.e. we have handled this branch already. Then it checks if the branch's conflict set has been already seen, which proofs that the current branch conflicts with an already traversed branch. Lastly it adds new branches to the queue of branches that should be traversed.</p> <div class=highlight><pre><span></span><code><span class=k>FUNCTION</span> <span class=nf>isConflicting</span> <span class=o>=</span> <span class=n>BranchCheck</span><span class=p>(</span><span class=n>branch</span><span class=p>)</span>
    <span class=p>#</span> <span class=n>abort</span> <span class=k>if</span> <span class=n>branch</span> <span class=n>was</span> <span class=n>traversed</span> <span class=n>already</span>
    <span class=k>IF</span> <span class=n>branch</span> <span class=ow>IN</span> <span class=n>traversedBranches</span> 
        <span class=k>RETURN</span> <span class=k>FALSE</span>
    <span class=k>ELSE</span> 
        <span class=n>Append</span><span class=p>(</span><span class=n>traversedBranches</span><span class=p>,</span><span class=n>branch</span><span class=p>.</span><span class=n>ID</span><span class=p>)</span>
    <span class=p>#</span> <span class=n>check</span> <span class=k>if</span> <span class=n>conflict</span> <span class=k>set</span> <span class=n>was</span> <span class=n>seen</span> <span class=n>twice</span>
    <span class=k>IF</span> <span class=n>branch</span><span class=p>.</span><span class=n>conflictSetID</span> <span class=ow>IN</span> <span class=n>seenConflictSets</span>
        <span class=k>RETURN</span> <span class=k>TRUE</span>
    <span class=k>ELSE</span> 
        <span class=n>Append</span><span class=p>(</span><span class=n>seenConflictSets</span><span class=p>,</span><span class=n>branch</span><span class=p>.</span><span class=n>conflictSetID</span><span class=p>)</span>

    <span class=p>#</span> <span class=n>queue</span> <span class=n>parents</span> <span class=k>to</span> <span class=n>be</span> <span class=n>checked</span> <span class=k>when</span> <span class=n>traversing</span> <span class=n>ancestors</span>
    <span class=k>FOR</span> <span class=n>parentBranch</span> <span class=ow>IN</span> <span class=n>branch</span><span class=p>.</span><span class=n>parentBranches</span>
        <span class=k>IF</span> <span class=n>branch</span> <span class=k>NOT</span> <span class=ow>IN</span> <span class=n>parentsToCheck</span>
            <span class=n>Append</span><span class=p>(</span><span class=n>parentsToCheck</span><span class=p>,</span><span class=n>parentBranch</span><span class=p>)</span>
    <span class=k>RETURN</span> <span class=k>FALSE</span>
</code></pre></div> <h3 id=5255-merging-of-branches>5.2.5.5 Merging of branches<a class=headerlink href=#5255-merging-of-branches title="Permanent link">&para;</a></h3> <p>A branch gains approval weight when messages from (previously non-attached) <code>nodeID</code>s attach to messages in the future cone of that branch. Once the approval weight exceeds a certain threshold we consider the branch as confirmed, see also section <a href=../6.4%20Finalization/ ><strong>6.4</strong> Finality</a>.</p> <p>However, there are two special cases of branches:</p> <p>First the branch that is created by the genesis transaction is called master branch and has the identifier <code>masterBranchID</code>. The <code>masterBranchID</code> is confirmed on creation and thus it is the "correct" reality by definition. Once a conflict branch is confirmed, it can be merged into the master branch. Since the approval weight is monotonically increasing for branches from the past to the future, branches are only merged into the master branch.</p> <p>Second, a branch <code>rejectedBranch</code> is created that is rejected by definition, and it has the identifier <code>rejectedBranchID</code>. Messages that are contained in a rejected branch or in one its child branches are booked into the <code>rejectedBranch</code>.</p> <h2 id=526-relation-to-the-tangle>5.2.6 Relation to the Tangle<a class=headerlink href=#526-relation-to-the-tangle title="Permanent link">&para;</a></h2> <p>Since messages in the Tangle are dependent on the fate of the messages they approve, we <em>shall</em> create dependencies between payloads, messages, and branches. The branch ID of a message or of a transaction represents all the conflicts upon which that object depends. Specifically, we associate a branch to a payload and to a message in the following way. </p> <ul> <li>The branch of a non-value payload is always the master branch.</li> <li>The branch of a transaction is assigned in one of two ways:<ul> <li>If the transaction is a conflict, then a new branch is created whose branchID is that transactionID. The transaction gets assigned to this new branch.</li> <li>Otherwise, the transaction is assigned to the aggregated branch of all its inputs.</li> </ul> </li> <li>The branch of a message is the aggregate of <ul> <li>The branch of its payload</li> <li>The branches of each strong parent</li> <li>The branches of the payloads of the weak parents.</li> </ul> </li> </ul> <p>This assignments captures the essence of weak and strong parents, see <a href=../4.3%20Tip%20Selection%20Algorithm/ >4.3 Tip Selection Specification</a>. Strong arrows pick up the dependencies of the whole past cone, where as the weak arrows only penetrate to the paylaod of the parent, ignoring the history of the parent.<br> We that a message <span class=arithmatex>\(M\)</span> (resp. transaction <span class=arithmatex>\(X\)</span>) belongs to a branch <span class=arithmatex>\(B\)</span> if the branch <span class=arithmatex>\(A\)</span> of <span class=arithmatex>\(M\)</span> (resp. <span class=arithmatex>\(X\)</span>) is in the branch past of <span class=arithmatex>\(B\)</span>. Thus, branches, represent certain coherent sections of the Tangle which are then ordered by inclusion.<br> After a message is solidified, it and its payload are both assigned to their branch. During this check, the message is flagged as invalid if: - The payload is a transaction, and the node cannot aggregate branchIDs of the transaction's input into a valid branchID. - The branchIF of the message cannot be aggregated. If these branchID's cannot be computed, then the message contains a pair of its history, and thus does not support a coherent view of the ledger. </p> <hr> <div class=md-source-date> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_datetime">2021-06-27 13:40:55</span> <br>Created: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_datetime">2021-06-27 13:25:10</span> </small> </div> </article> <script>var tabs=__get("__tabs");if(Array.isArray(tabs))for(var set of document.querySelectorAll("[data-tabs]")){var labels=set.querySelectorAll(":scope > label");e:for(var tab of tabs)for(var label of labels)if(label.innerText.trim()===tab){var input=label.previousElementSibling;input.checked=!0;break e}}</script> </div> </div> <a href=# class="md-top md-icon" title="Back to top" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../5.1%20UTXO/ class="md-footer__link md-footer__link--prev" aria-label="Previous: 5.1 UTXO" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> 5.1 UTXO </div> </div> </a> <a href=../5.3%20Mana/ class="md-footer__link md-footer__link--next" aria-label="Next: 5.3 Mana" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> 5.3 Mana </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2021 Zignar Technologies </div> </div> <div class=md-footer-social> <a href=https://twitter.com/zignartech target=_blank rel=noopener title=twitter.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> <a href=https://www.linkedin.com/company/zignar-technologies/ target=_blank rel=noopener title=www.linkedin.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=https://github.com/zignar-technologies target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://discord.gg/pEBc77shev target=_blank rel=noopener title=discord.gg class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M297.216 243.2c0 15.616-11.52 28.416-26.112 28.416-14.336 0-26.112-12.8-26.112-28.416s11.52-28.416 26.112-28.416c14.592 0 26.112 12.8 26.112 28.416zm-119.552-28.416c-14.592 0-26.112 12.8-26.112 28.416s11.776 28.416 26.112 28.416c14.592 0 26.112-12.8 26.112-28.416.256-15.616-11.52-28.416-26.112-28.416zM448 52.736V512c-64.494-56.994-43.868-38.128-118.784-107.776l13.568 47.36H52.48C23.552 451.584 0 428.032 0 398.848V52.736C0 23.552 23.552 0 52.48 0h343.04C424.448 0 448 23.552 448 52.736zm-72.96 242.688c0-82.432-36.864-149.248-36.864-149.248-36.864-27.648-71.936-26.88-71.936-26.88l-3.584 4.096c43.52 13.312 63.744 32.512 63.744 32.512-60.811-33.329-132.244-33.335-191.232-7.424-9.472 4.352-15.104 7.424-15.104 7.424s21.248-20.224 67.328-33.536l-2.56-3.072s-35.072-.768-71.936 26.88c0 0-36.864 66.816-36.864 149.248 0 0 21.504 37.12 78.08 38.912 0 0 9.472-11.52 17.152-21.248-32.512-9.728-44.8-30.208-44.8-30.208 3.766 2.636 9.976 6.053 10.496 6.4 43.21 24.198 104.588 32.126 159.744 8.96 8.96-3.328 18.944-8.192 29.44-15.104 0 0-12.8 20.992-46.336 30.464 7.68 9.728 16.896 20.736 16.896 20.736 56.576-1.792 78.336-38.912 78.336-38.912z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.tabs", "navigation.instant", "navigation.indexes", "navigation.tracking", "navigation.top", "header.autohide", "content.tabs.link", "search.suggest", "search.highlight", "search.share"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.df8cae7d.min.js", "version": null}</script> <script src=../../assets/javascripts/bundle.82217815.min.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js></script> <script src=../../javascripts/tables.js></script> <script src=../../javascripts/stl_viewer/stl_viewer.min.js></script> <script src=../../javascripts/extra.js></script> <script src=../../overrides/assets/javascripts/bundle.428d89bf.min.js></script> </body> </html>